#1 Aktualizacja systemu

sudo apt update && sudo apt upgrade -y

#2 Zainstaluj podstawowe narzÄ™dzia

sudo apt install -y software-properties-common curl unzip git

#3 Instalacja Apache

sudo apt install -y apache2

sudo systemctl start apache2
sudo systemctl enable apache2

#4 Instalacja PHP

sudo add-apt-repository ppa:ondrej/php -y
sudo apt update

sudo apt install -y php8.3 php8.3-cli php8.3-fpm php8.3-mysql php8.3-gd php8.3-ldap \
php8.3-mbstring php8.3-xml php8.3-curl php8.3-zip php8.3-bcmath php8.3-common \
php8.3-opcache php8.3-readline libapache2-mod-php8.3

sudo a2enmod php8.3

#5 Instalacja MySQL

sudo apt install -y mysql-server

sudo systemctl start mysql
sudo systemctl enable mysql

sudo mysql_secure_installation


sudo mysql -u root -p

CREATE DATABASE snipeit;
CREATE USER 'snipeit'@'localhost' IDENTIFIED BY 'TwojeSilneHaslo';
GRANT ALL PRIVILEGES ON snipeit.* TO 'snipeit'@'localhost';
FLUSH PRIVILEGES;
EXIT;


#6 Instalacja Composera

curl -sS https://getcomposer.org/installer | php
sudo mv composer.phar /usr/local/bin/composer

composer --version

#7 Pobranie i instalacja Snipe-IT

cd /var/www
sudo git clone -b v8.3.2 https://github.com/grokability/snipe-it snipe-it
sudo chown -R www-data:www-data /var/www/snipe-it
sudo chmod -R 755 /var/www/snipe-it

cd /var/www/snipe-it
sudo cp .env.example .env

sudo nano .env

APP_URL=http://10.0.0.4
DB_DATABASE=snipeit
DB_USERNAME=snipeit
DB_PASSWORD=TwojeSilneHaslo


composer install --no-dev --optimize-autoloader

php artisan key:generate

php artisan migrate

#8 Konfiguracja Apache dla Snipe-IT
sudo nano /etc/apache2/sites-available/snipeit.conf

<VirtualHost *:80>
    ServerName 10.0.0.4
    DocumentRoot /var/www/snipe-it/public

    <Directory /var/www/snipe-it/public>
        Options -Indexes +FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>

    ErrorLog ${APACHE_LOG_DIR}/snipeit-error.log
    CustomLog ${APACHE_LOG_DIR}/snipeit-access.log combined
</VirtualHost>

sudo a2ensite snipeit.conf

sudo a2dissite 000-default.conf

sudo a2enmod rewrite

sudo systemctl restart apache2

# 9 Gotowe ! 

